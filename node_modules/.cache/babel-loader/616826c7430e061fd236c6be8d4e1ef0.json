{"ast":null,"code":"var _jsxFileName = \"/home/fullzer4/Documents/GitHub/ToDoList/todolist/src/contexts/auth.js\",\n    _s = $RefreshSig$();\n\nimport { useState, useEffect, createContext } from \"react\";\nimport firebase from \"../services/firebaseConnection\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const AuthContext = /*#__PURE__*/createContext({});\nexport default function AuthProvider(_ref) {\n  _s();\n\n  let {\n    children\n  } = _ref;\n  const [user, setUser] = useState(null);\n  const [loadingAuth, setLoadingAuth] = useState(false);\n  const [loading, setLoading] = useState(true);\n  useEffect(() => {\n    function loadStorage() {\n      const storageUser = localStorage.getItem(\"SistemaUser\");\n\n      if (storageUser) {\n        setUser(JSON.parse(storageUser));\n        setLoading(false);\n      }\n\n      setLoading(false);\n    }\n\n    loadStorage();\n  }, []);\n\n  async function signIn(email, password) {\n    setLoadingAuth(true);\n    await firebase.auth().signInWithEmailAndPassword(email, password).then(async value => {\n      let uid = value.user.uid;\n    }).catch(error => {\n      console.log(error);\n      setLoadingAuth(false);\n    });\n  }\n\n  async function signUp(email, password, nome) {\n    setLoadingAuth(true);\n    await firebase.auth().createUserWithEmailAndPassword(email, password).then(async value => {\n      let uid = value.user.uid;\n      await firebase.firestore().collection(\"users\").doc(uid).set({\n        nome: nome,\n        avatarUrl: null\n      }).then(() => {\n        let data = {\n          uid: uid,\n          nome: nome,\n          email: value.user.email,\n          avatarUrl: null\n        };\n        setUser(data);\n        storageUser(data);\n        setLoadingAuth(false);\n      });\n    }).catch(error => {\n      console.log(error);\n      setLoadingAuth(false);\n    });\n  }\n\n  function storageUser(data) {\n    localStorage.setItem(\"SistemaUser\", JSON.stringify(data));\n  }\n\n  async function signOut() {\n    await firebase.auth().signOut();\n    localStorage.removeItem(\"SistemaUser\");\n    setUser(null);\n  }\n\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: {\n      signed: !!user,\n      user,\n      loading,\n      signUp,\n      signOut\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 79,\n    columnNumber: 9\n  }, this);\n}\n\n_s(AuthProvider, \"cfSgbtrX0hZURct7wRZEaA58SUs=\");\n\n_c = AuthProvider;\n\nvar _c;\n\n$RefreshReg$(_c, \"AuthProvider\");","map":{"version":3,"names":["useState","useEffect","createContext","firebase","AuthContext","AuthProvider","children","user","setUser","loadingAuth","setLoadingAuth","loading","setLoading","loadStorage","storageUser","localStorage","getItem","JSON","parse","signIn","email","password","auth","signInWithEmailAndPassword","then","value","uid","catch","error","console","log","signUp","nome","createUserWithEmailAndPassword","firestore","collection","doc","set","avatarUrl","data","setItem","stringify","signOut","removeItem","signed"],"sources":["/home/fullzer4/Documents/GitHub/ToDoList/todolist/src/contexts/auth.js"],"sourcesContent":["import { useState, useEffect, createContext} from \"react\"\nimport firebase from \"../services/firebaseConnection\"\n\nexport const AuthContext = createContext({})\n\nexport default function AuthProvider({children}){\n    const [user, setUser] =useState(null)\n    const [loadingAuth, setLoadingAuth] =useState(false)\n    const [loading, setLoading] = useState(true)\n\n    useEffect(()=>{\n        function loadStorage(){\n            const storageUser = localStorage.getItem(\"SistemaUser\")\n\n            if(storageUser){\n                setUser(JSON.parse(storageUser))\n                setLoading(false)\n            }\n\n            setLoading(false)\n        }\n        loadStorage()\n\n    },[])\n\n    async function signIn(email, password){\n        setLoadingAuth(true)\n\n        await firebase.auth().signInWithEmailAndPassword(email, password)\n        .then(async(value)=>{\n            let uid = value.user.uid\n        })\n        .catch((error)=>{\n            console.log(error);\n            setLoadingAuth(false)\n        })\n    }\n\n    async function signUp(email, password, nome){\n        setLoadingAuth(true)\n        await firebase.auth().createUserWithEmailAndPassword(email, password)\n        .then(async(value)=>{\n            let uid = value.user.uid\n            await firebase.firestore().collection(\"users\")\n            .doc(uid).set({\n                nome: nome,\n                avatarUrl:null,\n            })\n            .then(()=>{\n                let data = {\n                    uid: uid,\n                    nome: nome,\n                    email: value.user.email,\n                    avatarUrl: null\n                }\n\n                setUser(data)\n                storageUser(data)\n                setLoadingAuth(false)\n            })\n        })\n        .catch((error) =>{\n            console.log(error);\n            setLoadingAuth(false)\n        })\n    }\n\n    function storageUser(data){\n        localStorage.setItem(\"SistemaUser\", JSON.stringify(data))\n    }\n\n    async function signOut(){\n        await firebase.auth().signOut()\n        localStorage.removeItem(\"SistemaUser\")\n        setUser(null)\n    }\n\n    return(\n        <AuthContext.Provider value={{signed: !!user, user, loading, signUp, signOut}}>\n            {children}\n        </AuthContext.Provider>\n    )\n}"],"mappings":";;;AAAA,SAASA,QAAT,EAAmBC,SAAnB,EAA8BC,aAA9B,QAAkD,OAAlD;AACA,OAAOC,QAAP,MAAqB,gCAArB;;AAEA,OAAO,MAAMC,WAAW,gBAAGF,aAAa,CAAC,EAAD,CAAjC;AAEP,eAAe,SAASG,YAAT,OAAiC;EAAA;;EAAA,IAAX;IAACC;EAAD,CAAW;EAC5C,MAAM,CAACC,IAAD,EAAOC,OAAP,IAAiBR,QAAQ,CAAC,IAAD,CAA/B;EACA,MAAM,CAACS,WAAD,EAAcC,cAAd,IAA+BV,QAAQ,CAAC,KAAD,CAA7C;EACA,MAAM,CAACW,OAAD,EAAUC,UAAV,IAAwBZ,QAAQ,CAAC,IAAD,CAAtC;EAEAC,SAAS,CAAC,MAAI;IACV,SAASY,WAAT,GAAsB;MAClB,MAAMC,WAAW,GAAGC,YAAY,CAACC,OAAb,CAAqB,aAArB,CAApB;;MAEA,IAAGF,WAAH,EAAe;QACXN,OAAO,CAACS,IAAI,CAACC,KAAL,CAAWJ,WAAX,CAAD,CAAP;QACAF,UAAU,CAAC,KAAD,CAAV;MACH;;MAEDA,UAAU,CAAC,KAAD,CAAV;IACH;;IACDC,WAAW;EAEd,CAbQ,EAaP,EAbO,CAAT;;EAeA,eAAeM,MAAf,CAAsBC,KAAtB,EAA6BC,QAA7B,EAAsC;IAClCX,cAAc,CAAC,IAAD,CAAd;IAEA,MAAMP,QAAQ,CAACmB,IAAT,GAAgBC,0BAAhB,CAA2CH,KAA3C,EAAkDC,QAAlD,EACLG,IADK,CACA,MAAMC,KAAN,IAAc;MAChB,IAAIC,GAAG,GAAGD,KAAK,CAAClB,IAAN,CAAWmB,GAArB;IACH,CAHK,EAILC,KAJK,CAIEC,KAAD,IAAS;MACZC,OAAO,CAACC,GAAR,CAAYF,KAAZ;MACAlB,cAAc,CAAC,KAAD,CAAd;IACH,CAPK,CAAN;EAQH;;EAED,eAAeqB,MAAf,CAAsBX,KAAtB,EAA6BC,QAA7B,EAAuCW,IAAvC,EAA4C;IACxCtB,cAAc,CAAC,IAAD,CAAd;IACA,MAAMP,QAAQ,CAACmB,IAAT,GAAgBW,8BAAhB,CAA+Cb,KAA/C,EAAsDC,QAAtD,EACLG,IADK,CACA,MAAMC,KAAN,IAAc;MAChB,IAAIC,GAAG,GAAGD,KAAK,CAAClB,IAAN,CAAWmB,GAArB;MACA,MAAMvB,QAAQ,CAAC+B,SAAT,GAAqBC,UAArB,CAAgC,OAAhC,EACLC,GADK,CACDV,GADC,EACIW,GADJ,CACQ;QACVL,IAAI,EAAEA,IADI;QAEVM,SAAS,EAAC;MAFA,CADR,EAKLd,IALK,CAKA,MAAI;QACN,IAAIe,IAAI,GAAG;UACPb,GAAG,EAAEA,GADE;UAEPM,IAAI,EAAEA,IAFC;UAGPZ,KAAK,EAAEK,KAAK,CAAClB,IAAN,CAAWa,KAHX;UAIPkB,SAAS,EAAE;QAJJ,CAAX;QAOA9B,OAAO,CAAC+B,IAAD,CAAP;QACAzB,WAAW,CAACyB,IAAD,CAAX;QACA7B,cAAc,CAAC,KAAD,CAAd;MACH,CAhBK,CAAN;IAiBH,CApBK,EAqBLiB,KArBK,CAqBEC,KAAD,IAAU;MACbC,OAAO,CAACC,GAAR,CAAYF,KAAZ;MACAlB,cAAc,CAAC,KAAD,CAAd;IACH,CAxBK,CAAN;EAyBH;;EAED,SAASI,WAAT,CAAqByB,IAArB,EAA0B;IACtBxB,YAAY,CAACyB,OAAb,CAAqB,aAArB,EAAoCvB,IAAI,CAACwB,SAAL,CAAeF,IAAf,CAApC;EACH;;EAED,eAAeG,OAAf,GAAwB;IACpB,MAAMvC,QAAQ,CAACmB,IAAT,GAAgBoB,OAAhB,EAAN;IACA3B,YAAY,CAAC4B,UAAb,CAAwB,aAAxB;IACAnC,OAAO,CAAC,IAAD,CAAP;EACH;;EAED,oBACI,QAAC,WAAD,CAAa,QAAb;IAAsB,KAAK,EAAE;MAACoC,MAAM,EAAE,CAAC,CAACrC,IAAX;MAAiBA,IAAjB;MAAuBI,OAAvB;MAAgCoB,MAAhC;MAAwCW;IAAxC,CAA7B;IAAA,UACKpC;EADL;IAAA;IAAA;IAAA;EAAA,QADJ;AAKH;;GA7EuBD,Y;;KAAAA,Y"},"metadata":{},"sourceType":"module"}