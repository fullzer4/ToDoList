{"ast":null,"code":"import _regeneratorRuntime from\"/home/fullzer4/Documents/GitHub/ToDoList/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/home/fullzer4/Documents/GitHub/ToDoList/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/home/fullzer4/Documents/GitHub/ToDoList/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useState,createContext,useEffect}from'react';import firebase from'../services/firebaseConnection';import{toast}from'react-toastify';import{jsx as _jsx}from\"react/jsx-runtime\";export var AuthContext=/*#__PURE__*/createContext({});function AuthProvider(_ref){var children=_ref.children;var _useState=useState(null),_useState2=_slicedToArray(_useState,2),user=_useState2[0],setUser=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),loadingAuth=_useState4[0],setLoadingAuth=_useState4[1];var _useState5=useState(true),_useState6=_slicedToArray(_useState5,2),loading=_useState6[0],setLoading=_useState6[1];useEffect(function(){function loadStorage(){var storageUser=localStorage.getItem('SistemaUser');if(storageUser){setUser(JSON.parse(storageUser));setLoading(false);}setLoading(false);}loadStorage();},[]);//Fazendo login do usuario\nfunction signIn(_x,_x2){return _signIn.apply(this,arguments);}//Cadastrando um novo usuario\nfunction _signIn(){_signIn=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(email,password){return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:setLoadingAuth(true);_context2.next=3;return firebase.auth().signInWithEmailAndPassword(email,password).then(/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(value){var uid,userProfile,data;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:uid=value.user.uid;_context.next=3;return firebase.firestore().collection('users').doc(uid).get();case 3:userProfile=_context.sent;data={uid:uid,nome:userProfile.data().nome,email:value.user.email};setUser(data);storageUser(data);setLoadingAuth(false);toast.success(\"Bem vindo de volta\");case 9:case\"end\":return _context.stop();}}},_callee);}));return function(_x6){return _ref2.apply(this,arguments);};}()).catch(function(error){console.log(error);setLoadingAuth(false);toast.error(\"algo deu errado\");});case 3:case\"end\":return _context2.stop();}}},_callee2);}));return _signIn.apply(this,arguments);}function signUp(_x3,_x4,_x5){return _signUp.apply(this,arguments);}function _signUp(){_signUp=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee4(email,password,nome){return _regeneratorRuntime().wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:setLoadingAuth(true);_context4.next=3;return firebase.auth().createUserWithEmailAndPassword(email,password).then(/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(value){var uid;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:uid=value.user.uid;_context3.next=3;return firebase.firestore().collection('users').doc(uid).set({nome:nome}).then(function(){var data={uid:uid,nome:nome,email:value.user.email};setUser(data);storageUser(data);setLoadingAuth(false);toast.success(\"Bem vindo\");});case 3:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x7){return _ref3.apply(this,arguments);};}()).catch(function(error){console.log(error);setLoadingAuth(false);toast.error(\"Algo deu errado\");});case 3:case\"end\":return _context4.stop();}}},_callee4);}));return _signUp.apply(this,arguments);}function storageUser(data){localStorage.setItem('SistemaUser',JSON.stringify(data));}//Logout do usuario\nfunction signOut(){return _signOut.apply(this,arguments);}function _signOut(){_signOut=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee5(){return _regeneratorRuntime().wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_context5.next=2;return firebase.auth().signOut();case 2:localStorage.removeItem('SistemaUser');setUser(null);case 4:case\"end\":return _context5.stop();}}},_callee5);}));return _signOut.apply(this,arguments);}return/*#__PURE__*/_jsx(AuthContext.Provider,{value:{signed:!!user,user:user,loading:loading,signUp:signUp,signOut:signOut,signIn:signIn,loadingAuth:loadingAuth},children:children});}export default AuthProvider;","map":{"version":3,"names":["useState","createContext","useEffect","firebase","toast","AuthContext","AuthProvider","children","user","setUser","loadingAuth","setLoadingAuth","loading","setLoading","loadStorage","storageUser","localStorage","getItem","JSON","parse","signIn","email","password","auth","signInWithEmailAndPassword","then","value","uid","firestore","collection","doc","get","userProfile","data","nome","success","catch","error","console","log","signUp","createUserWithEmailAndPassword","set","setItem","stringify","signOut","removeItem","signed"],"sources":["/home/fullzer4/Documents/GitHub/ToDoList/src/contexts/auth.js"],"sourcesContent":["import { useState, createContext, useEffect } from 'react';\nimport firebase from '../services/firebaseConnection';\nimport { toast } from 'react-toastify';\n\nexport const AuthContext = createContext({});\n\nfunction AuthProvider({ children }){\n  const [user, setUser] = useState(null);\n  const [loadingAuth, setLoadingAuth] = useState(false);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(()=>{\n\n    function loadStorage(){\n      const storageUser = localStorage.getItem('SistemaUser');\n\n      if(storageUser){\n        setUser(JSON.parse(storageUser));\n        setLoading(false);\n      }\n  \n      setLoading(false);\n    }\n    \n    loadStorage();\n\n  }, [])\n\n\n  //Fazendo login do usuario\n  async function signIn(email, password){\n    setLoadingAuth(true);\n\n    await firebase.auth().signInWithEmailAndPassword(email, password)\n    .then(async (value)=> {\n      let uid = value.user.uid;\n\n      const userProfile = await firebase.firestore().collection('users')\n      .doc(uid).get();\n\n      let data = {\n        uid: uid,\n        nome: userProfile.data().nome,\n        email: value.user.email\n      };\n\n      setUser(data);\n      storageUser(data);\n      setLoadingAuth(false);\n      toast.success(\"Bem vindo de volta\")\n\n\n    })\n    .catch((error)=>{\n      console.log(error);\n      setLoadingAuth(false);\n      toast.error(\"algo deu errado\")\n    })\n\n  }\n\n\n  //Cadastrando um novo usuario\n  async function signUp(email, password, nome){\n    setLoadingAuth(true);\n\n    await firebase.auth().createUserWithEmailAndPassword(email, password)\n    .then( async (value)=>{\n      let uid = value.user.uid;\n\n      await firebase.firestore().collection('users')\n      .doc(uid).set({\n        nome: nome,\n      })\n      .then( () => {\n\n        let data = {\n          uid: uid,\n          nome: nome,\n          email: value.user.email,\n        };\n\n        setUser(data);\n        storageUser(data);\n        setLoadingAuth(false);\n        toast.success(\"Bem vindo\")\n\n      })\n\n    })\n    .catch((error)=>{\n      console.log(error);\n      setLoadingAuth(false);\n      toast.error(\"Algo deu errado\")\n    })\n\n  }\n\n\n\n  function storageUser(data){\n    localStorage.setItem('SistemaUser', JSON.stringify(data));\n  }\n\n\n\n  //Logout do usuario\n  async function signOut(){\n    await firebase.auth().signOut();\n    localStorage.removeItem('SistemaUser');\n    setUser(null);\n  }\n\n\n  return(\n    <AuthContext.Provider \n    value={{ \n      signed: !!user,  \n      user, \n      loading, \n      signUp,\n      signOut,\n      signIn,\n      loadingAuth\n    }}\n    >\n      {children}\n    </AuthContext.Provider>\n  )\n}\n\nexport default AuthProvider;"],"mappings":"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"},"metadata":{},"sourceType":"module"}