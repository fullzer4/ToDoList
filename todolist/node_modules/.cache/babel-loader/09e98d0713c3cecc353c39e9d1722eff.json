{"ast":null,"code":"var _jsxFileName = \"/home/fullzer4/Documents/GitHub/ToDoList/todolist/src/contexts/auth.js\",\n    _s = $RefreshSig$();\n\nimport { useState, useEffect, createContext } from \"react\";\nimport firebase from \"../services/firebaseConnection\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const AuthContext = /*#__PURE__*/createContext({});\nexport default function AuthProvider(_ref) {\n  _s();\n\n  let {\n    children\n  } = _ref;\n  const [user, setUser] = useState(null);\n  const [loadingAuth, setLoadingAuth] = useState(false);\n  const [loading, setLoading] = useState(true);\n  useEffect(() => {\n    function loadStorage() {\n      const storageUser = localStorage.getItem(\"SistemaUser\");\n\n      if (storageUser) {\n        setUser(JSON.parse(storageUser));\n        setLoading(false);\n      }\n\n      setLoading(false);\n    }\n\n    loadStorage();\n  }, []);\n\n  async function signUp(email, password, nome) {\n    setLoadingAuth(true);\n    await firebase.auth().createUserWithEmailAndPassword(email, password).then(async value => {\n      let uid = value.user.uid;\n      await firebase.firestore().collection(\"users\").doc(uid).set({\n        nome: nome,\n        avatarUrl: null\n      }).then(() => {\n        let data = {\n          uid: uid,\n          nome: nome,\n          email: value.user.email,\n          avatarUrl: null\n        };\n        setUser(data);\n        storageUser(data);\n        setLoadingAuth(false);\n      });\n    }).catch(error => {\n      console.log(error);\n      setLoadingAuth(false);\n    });\n  }\n\n  function storageUser(data) {\n    localStorage.setItem(\"SistemaUser\", JSON.stringify(data));\n  }\n\n  async function signOut() {\n    await firebase.auth().signOut();\n    localStorage.removeItem(\"SistemaUser\");\n    setUser(null);\n  }\n\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: {\n      signed: !!user,\n      user,\n      loading,\n      signUp,\n      signOut\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 66,\n    columnNumber: 9\n  }, this);\n}\n\n_s(AuthProvider, \"cfSgbtrX0hZURct7wRZEaA58SUs=\");\n\n_c = AuthProvider;\n\nvar _c;\n\n$RefreshReg$(_c, \"AuthProvider\");","map":{"version":3,"names":["useState","useEffect","createContext","firebase","AuthContext","AuthProvider","children","user","setUser","loadingAuth","setLoadingAuth","loading","setLoading","loadStorage","storageUser","localStorage","getItem","JSON","parse","signUp","email","password","nome","auth","createUserWithEmailAndPassword","then","value","uid","firestore","collection","doc","set","avatarUrl","data","catch","error","console","log","setItem","stringify","signOut","removeItem","signed"],"sources":["/home/fullzer4/Documents/GitHub/ToDoList/todolist/src/contexts/auth.js"],"sourcesContent":["import { useState, useEffect, createContext} from \"react\"\nimport firebase from \"../services/firebaseConnection\"\n\nexport const AuthContext = createContext({})\n\nexport default function AuthProvider({children}){\n    const [user, setUser] =useState(null)\n    const [loadingAuth, setLoadingAuth] =useState(false)\n    const [loading, setLoading] = useState(true)\n\n    useEffect(()=>{\n        function loadStorage(){\n            const storageUser = localStorage.getItem(\"SistemaUser\")\n\n            if(storageUser){\n                setUser(JSON.parse(storageUser))\n                setLoading(false)\n            }\n\n            setLoading(false)\n        }\n        loadStorage()\n\n    },[])\n\n    async function signUp(email, password, nome){\n        setLoadingAuth(true)\n        await firebase.auth().createUserWithEmailAndPassword(email, password)\n        .then(async(value)=>{\n            let uid = value.user.uid\n            await firebase.firestore().collection(\"users\")\n            .doc(uid).set({\n                nome: nome,\n                avatarUrl:null,\n            })\n            .then(()=>{\n                let data = {\n                    uid: uid,\n                    nome: nome,\n                    email: value.user.email,\n                    avatarUrl: null\n                }\n\n                setUser(data)\n                storageUser(data)\n                setLoadingAuth(false)\n            })\n        })\n        .catch((error) =>{\n            console.log(error);\n            setLoadingAuth(false)\n        })\n    }\n\n    function storageUser(data){\n        localStorage.setItem(\"SistemaUser\", JSON.stringify(data))\n    }\n\n    async function signOut(){\n        await firebase.auth().signOut()\n        localStorage.removeItem(\"SistemaUser\")\n        setUser(null)\n    }\n\n    return(\n        <AuthContext.Provider value={{signed: !!user, user, loading, signUp, signOut}}>\n            {children}\n        </AuthContext.Provider>\n    )\n}"],"mappings":";;;AAAA,SAASA,QAAT,EAAmBC,SAAnB,EAA8BC,aAA9B,QAAkD,OAAlD;AACA,OAAOC,QAAP,MAAqB,gCAArB;;AAEA,OAAO,MAAMC,WAAW,gBAAGF,aAAa,CAAC,EAAD,CAAjC;AAEP,eAAe,SAASG,YAAT,OAAiC;EAAA;;EAAA,IAAX;IAACC;EAAD,CAAW;EAC5C,MAAM,CAACC,IAAD,EAAOC,OAAP,IAAiBR,QAAQ,CAAC,IAAD,CAA/B;EACA,MAAM,CAACS,WAAD,EAAcC,cAAd,IAA+BV,QAAQ,CAAC,KAAD,CAA7C;EACA,MAAM,CAACW,OAAD,EAAUC,UAAV,IAAwBZ,QAAQ,CAAC,IAAD,CAAtC;EAEAC,SAAS,CAAC,MAAI;IACV,SAASY,WAAT,GAAsB;MAClB,MAAMC,WAAW,GAAGC,YAAY,CAACC,OAAb,CAAqB,aAArB,CAApB;;MAEA,IAAGF,WAAH,EAAe;QACXN,OAAO,CAACS,IAAI,CAACC,KAAL,CAAWJ,WAAX,CAAD,CAAP;QACAF,UAAU,CAAC,KAAD,CAAV;MACH;;MAEDA,UAAU,CAAC,KAAD,CAAV;IACH;;IACDC,WAAW;EAEd,CAbQ,EAaP,EAbO,CAAT;;EAeA,eAAeM,MAAf,CAAsBC,KAAtB,EAA6BC,QAA7B,EAAuCC,IAAvC,EAA4C;IACxCZ,cAAc,CAAC,IAAD,CAAd;IACA,MAAMP,QAAQ,CAACoB,IAAT,GAAgBC,8BAAhB,CAA+CJ,KAA/C,EAAsDC,QAAtD,EACLI,IADK,CACA,MAAMC,KAAN,IAAc;MAChB,IAAIC,GAAG,GAAGD,KAAK,CAACnB,IAAN,CAAWoB,GAArB;MACA,MAAMxB,QAAQ,CAACyB,SAAT,GAAqBC,UAArB,CAAgC,OAAhC,EACLC,GADK,CACDH,GADC,EACII,GADJ,CACQ;QACVT,IAAI,EAAEA,IADI;QAEVU,SAAS,EAAC;MAFA,CADR,EAKLP,IALK,CAKA,MAAI;QACN,IAAIQ,IAAI,GAAG;UACPN,GAAG,EAAEA,GADE;UAEPL,IAAI,EAAEA,IAFC;UAGPF,KAAK,EAAEM,KAAK,CAACnB,IAAN,CAAWa,KAHX;UAIPY,SAAS,EAAE;QAJJ,CAAX;QAOAxB,OAAO,CAACyB,IAAD,CAAP;QACAnB,WAAW,CAACmB,IAAD,CAAX;QACAvB,cAAc,CAAC,KAAD,CAAd;MACH,CAhBK,CAAN;IAiBH,CApBK,EAqBLwB,KArBK,CAqBEC,KAAD,IAAU;MACbC,OAAO,CAACC,GAAR,CAAYF,KAAZ;MACAzB,cAAc,CAAC,KAAD,CAAd;IACH,CAxBK,CAAN;EAyBH;;EAED,SAASI,WAAT,CAAqBmB,IAArB,EAA0B;IACtBlB,YAAY,CAACuB,OAAb,CAAqB,aAArB,EAAoCrB,IAAI,CAACsB,SAAL,CAAeN,IAAf,CAApC;EACH;;EAED,eAAeO,OAAf,GAAwB;IACpB,MAAMrC,QAAQ,CAACoB,IAAT,GAAgBiB,OAAhB,EAAN;IACAzB,YAAY,CAAC0B,UAAb,CAAwB,aAAxB;IACAjC,OAAO,CAAC,IAAD,CAAP;EACH;;EAED,oBACI,QAAC,WAAD,CAAa,QAAb;IAAsB,KAAK,EAAE;MAACkC,MAAM,EAAE,CAAC,CAACnC,IAAX;MAAiBA,IAAjB;MAAuBI,OAAvB;MAAgCQ,MAAhC;MAAwCqB;IAAxC,CAA7B;IAAA,UACKlC;EADL;IAAA;IAAA;IAAA;EAAA,QADJ;AAKH;;GAhEuBD,Y;;KAAAA,Y"},"metadata":{},"sourceType":"module"}