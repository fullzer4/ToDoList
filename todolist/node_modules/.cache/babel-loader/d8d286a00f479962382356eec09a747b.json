{"ast":null,"code":"var _jsxFileName = \"/home/fullzer4/Documents/GitHub/ToDoList/todolist/src/contexts/auth.js\",\n    _s = $RefreshSig$();\n\nimport { useState, createContext, useEffect } from 'react';\nimport firebase from '../services/firebaseConnection';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const AuthContext = /*#__PURE__*/createContext({});\n\nfunction AuthProvider(_ref) {\n  _s();\n\n  let {\n    children\n  } = _ref;\n  const [user, setUser] = useState(null);\n  const [loadingAuth, setLoadingAuth] = useState(false);\n  const [loading, setLoading] = useState(true);\n  useEffect(() => {\n    function loadStorage() {\n      const storageUser = localStorage.getItem('SistemaUser');\n\n      if (storageUser) {\n        setUser(JSON.parse(storageUser));\n        setLoading(false);\n      }\n\n      setLoading(false);\n    }\n\n    loadStorage();\n  }, []); //Fazendo login do usuario\n\n  async function signIn(email, password) {\n    setLoadingAuth(true);\n    await firebase.auth().signInWithEmailAndPassword(email, password).then(async value => {\n      let uid = value.user.uid;\n      const userProfile = await firebase.firestore().collection('users').doc(uid).get();\n      let data = {\n        uid: uid,\n        nome: userProfile.data().nome,\n        avatarUrl: userProfile.data().avatarUrl,\n        email: value.user.email\n      };\n      setUser(data);\n      storageUser(data);\n      setLoadingAuth(false);\n    }).catch(error => {\n      console.log(error);\n      setLoadingAuth(false);\n    });\n  } //Cadastrando um novo usuario\n\n\n  async function signUp(email, password, nome) {\n    setLoadingAuth(true);\n    await firebase.auth().createUserWithEmailAndPassword(email, password).then(async value => {\n      let uid = value.user.uid;\n      await firebase.firestore().collection('users').doc(uid).set({\n        nome: nome,\n        avatarUrl: null\n      }).then(() => {\n        let data = {\n          uid: uid,\n          nome: nome,\n          email: value.user.email,\n          avatarUrl: null\n        };\n        setUser(data);\n        storageUser(data);\n        setLoadingAuth(false);\n      });\n    }).catch(error => {\n      console.log(error);\n      setLoadingAuth(false);\n    });\n  }\n\n  function storageUser(data) {\n    localStorage.setItem('SistemaUser', JSON.stringify(data));\n  } //Logout do usuario\n\n\n  async function signOut() {\n    await firebase.auth().signOut();\n    localStorage.removeItem('SistemaUser');\n    setUser(null);\n  }\n\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: {\n      signed: !!user,\n      user,\n      loading,\n      signUp,\n      signOut,\n      signIn,\n      loadingAuth\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 114,\n    columnNumber: 5\n  }, this);\n}\n\n_s(AuthProvider, \"cfSgbtrX0hZURct7wRZEaA58SUs=\");\n\n_c = AuthProvider;\nexport default AuthProvider;\n\nvar _c;\n\n$RefreshReg$(_c, \"AuthProvider\");","map":{"version":3,"names":["useState","createContext","useEffect","firebase","AuthContext","AuthProvider","children","user","setUser","loadingAuth","setLoadingAuth","loading","setLoading","loadStorage","storageUser","localStorage","getItem","JSON","parse","signIn","email","password","auth","signInWithEmailAndPassword","then","value","uid","userProfile","firestore","collection","doc","get","data","nome","avatarUrl","catch","error","console","log","signUp","createUserWithEmailAndPassword","set","setItem","stringify","signOut","removeItem","signed"],"sources":["/home/fullzer4/Documents/GitHub/ToDoList/todolist/src/contexts/auth.js"],"sourcesContent":["import { useState, createContext, useEffect } from 'react';\nimport firebase from '../services/firebaseConnection';\n\nexport const AuthContext = createContext({});\n\nfunction AuthProvider({ children }){\n  const [user, setUser] = useState(null);\n  const [loadingAuth, setLoadingAuth] = useState(false);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(()=>{\n\n    function loadStorage(){\n      const storageUser = localStorage.getItem('SistemaUser');\n\n      if(storageUser){\n        setUser(JSON.parse(storageUser));\n        setLoading(false);\n      }\n  \n      setLoading(false);\n    }\n    \n    loadStorage();\n\n  }, [])\n\n\n  //Fazendo login do usuario\n  async function signIn(email, password){\n    setLoadingAuth(true);\n\n    await firebase.auth().signInWithEmailAndPassword(email, password)\n    .then(async (value)=> {\n      let uid = value.user.uid;\n\n      const userProfile = await firebase.firestore().collection('users')\n      .doc(uid).get();\n\n      let data = {\n        uid: uid,\n        nome: userProfile.data().nome,\n        avatarUrl: userProfile.data().avatarUrl,\n        email: value.user.email\n      };\n\n      setUser(data);\n      storageUser(data);\n      setLoadingAuth(false);\n\n\n    })\n    .catch((error)=>{\n      console.log(error);\n      setLoadingAuth(false);\n    })\n\n  }\n\n\n  //Cadastrando um novo usuario\n  async function signUp(email, password, nome){\n    setLoadingAuth(true);\n\n    await firebase.auth().createUserWithEmailAndPassword(email, password)\n    .then( async (value)=>{\n      let uid = value.user.uid;\n\n      await firebase.firestore().collection('users')\n      .doc(uid).set({\n        nome: nome,\n        avatarUrl: null,\n      })\n      .then( () => {\n\n        let data = {\n          uid: uid,\n          nome: nome,\n          email: value.user.email,\n          avatarUrl: null\n        };\n\n        setUser(data);\n        storageUser(data);\n        setLoadingAuth(false);\n\n      })\n\n    })\n    .catch((error)=>{\n      console.log(error);\n      setLoadingAuth(false);\n    })\n\n  }\n\n\n\n  function storageUser(data){\n    localStorage.setItem('SistemaUser', JSON.stringify(data));\n  }\n\n\n\n  //Logout do usuario\n  async function signOut(){\n    await firebase.auth().signOut();\n    localStorage.removeItem('SistemaUser');\n    setUser(null);\n  }\n\n\n  return(\n    <AuthContext.Provider \n    value={{ \n      signed: !!user,  \n      user, \n      loading, \n      signUp,\n      signOut,\n      signIn,\n      loadingAuth\n    }}\n    >\n      {children}\n    </AuthContext.Provider>\n  )\n}\n\nexport default AuthProvider;"],"mappings":"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"},"metadata":{},"sourceType":"module"}